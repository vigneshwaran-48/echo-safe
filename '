package sidebar

import (
	"fmt"
	"github.com/vigneshwaran-48/echo-safe/internal/models"
	"github.com/vigneshwaran-48/echo-safe/internal/templates/icons/note"
	"github.com/vigneshwaran-48/echo-safe/internal/templates/icons/sidebar"
)

templ sidebarNote(note models.Note) {
	<li class="nav-link p-2 hover:bg-dark-hover hover:text-primary-text transition rounded cursor-pointer">
		<a
			hx-get={ string(templ.URL(fmt.Sprintf("/notes/%d", note.Id))) }
			hx-push-url="true"
			hx-target="#main-content"
			_="on click remove .bg-dark-hover .text-primary-text from .nav-link then add .bg-dark-hover .text-primary-text to me"
		>
			<p>{ note.Title }</p>
		</a>
	</li>
}

templ topbarIcons(icon templ.Component, id string) {
	<span id={ id } class="px-2">
		@icon
	</span>
}

templ SideTopbar() {
	<div class="flex items-center">
		@topbarIcons(sidebar.SidebarIcon("w-[20px] text-white"), "sidebar-toggle")
		<span>
			@topbarIcons(note.NoteIcon(), "create-note")
		</span>
	</div>
}

templ Sidebar(notes []models.Note) {
	<nav id="sidebar" class="h-full bg-dark w-[200px] flex flex-col space-between transition-all overflow-hidden duration-100">
		<div class="w-full h-[calc(100%-50px)] border-t border-b border-r border-gray-700">
			<ul class="p-2">
				for _, note := range notes {
					@sidebarNote(note)
				}
			</ul>
		</div>
		<div class="w-full"></div>
	</nav>
}
